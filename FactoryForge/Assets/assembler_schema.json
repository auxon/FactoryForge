{
  "$schema": "https://example.com/machineui.schema.json",
  "version": "1.0.0",
  "id": "machineui.assembler",
  "machineKind": "assembler",
  "title": "Assembling Machine",
  "layout": {
    "flowAxis": "leftToRight",
    "safeArea": { "top": 16, "left": 16, "bottom": 16, "right": 16 },
    "padding": { "x": 24, "y": 24 },
    "grid": { "columns": 12, "rows": 8, "gutterX": 8, "gutterY": 12 }
  },

  "groups": [
    {
      "id": "input",
      "role": "input",
      "header": { "text": "Input", "styleRole": "input", "alignment": "leading" },
      "anchor": { "gridX": 0, "gridY": 0, "spanX": 3, "spanY": 3, "alignX": "leading", "alignY": "top" },
      "content": {
        "slots": [
          { "id": "input.slot0", "slotKind": "item", "capacity": { "maxStacks": 1 }, "accepts": { "tags": [] }, "renders": { "sizeDp": 48, "style": "square", "overlay": "count" } },
          { "id": "input.slot1", "slotKind": "item", "capacity": { "maxStacks": 1 }, "accepts": { "tags": [] }, "renders": { "sizeDp": 48, "style": "square", "overlay": "count" } },
          { "id": "input.slot2", "slotKind": "item", "capacity": { "maxStacks": 1 }, "accepts": { "tags": [] }, "renders": { "sizeDp": 48, "style": "square", "overlay": "count" } },
          { "id": "input.slot3", "slotKind": "item", "capacity": { "maxStacks": 1 }, "accepts": { "tags": [] }, "renders": { "sizeDp": 48, "style": "square", "overlay": "count" } }
        ],
        "stateText": { "mode": "auto", "empty": "(insert ingredients)", "nonEmpty": "" }
      }
    },

    {
      "id": "output",
      "role": "output",
      "header": { "text": "Output", "styleRole": "output", "alignment": "leading" },
      "anchor": { "gridX": 7, "gridY": 0, "spanX": 3, "spanY": 3, "alignX": "leading", "alignY": "top" },
      "content": {
        "slots": [
          { "id": "output.slot0", "slotKind": "item", "capacity": { "maxStacks": 1 }, "accepts": { "tags": [] }, "renders": { "sizeDp": 48, "style": "square", "overlay": "count" } },
          { "id": "output.slot1", "slotKind": "item", "capacity": { "maxStacks": 1 }, "accepts": { "tags": [] }, "renders": { "sizeDp": 48, "style": "square", "overlay": "count" } },
          { "id": "output.slot2", "slotKind": "item", "capacity": { "maxStacks": 1 }, "accepts": { "tags": [] }, "renders": { "sizeDp": 48, "style": "square", "overlay": "count" } },
          { "id": "output.slot3", "slotKind": "item", "capacity": { "maxStacks": 1 }, "accepts": { "tags": [] }, "renders": { "sizeDp": 48, "style": "square", "overlay": "count" } }
        ],
        "stateText": { "mode": "auto", "empty": "(idle)", "nonEmpty": "" }
      }
    }
  ],

  "process": {
    "id": "crafting",
    "label": { "text": "Crafting", "styleRole": "process", "alignment": "center" },
    "anchor": { "gridX": 3, "gridY": 0, "spanX": 4, "spanY": 3, "alignX": "fill", "alignY": "fill" },
    "progress": { "style": "bar", "bindTo": "recipeProgress", "showPercent": false },
    "operators": { "showFlowGlyphs": false, "glyphStyleRole": "muted" }
  },

  "recipes": {
    "title": "Available Recipes",
    "mode": "picker",
    "anchor": { "gridX": 0, "gridY": 3, "spanX": 10, "spanY": 4, "alignX": "fill", "alignY": "fill" },
    "grid": { "cellSizeDp": 48, "columns": 6, "rowSpacingDp": 8, "colSpacingDp": 8 }
  },

  "style": {
    "palette": {
      "fuel": "#FFAA00",
      "input": "#00AAFF",
      "output": "#00FF00",
      "process": "#FFA500",
      "mutedText": "#CCCCCC"
    },
    "typography": {
      "headerSize": 14,
      "bodySize": 12,
      "mutedSize": 10
    },
    "chrome": {
      "panelOpacity": 1.0,
      "cornerRadiusDp": 8,
      "labelBackplateOpacity": 0.5
    }
  },

  "invariants": [
    "Every GroupHeader must be a descendant of exactly one Group.",
    "No floating labels: GroupHeader must not be sibling of Slot; it must be ancestor (container header).",
    "Process.progress must be visually adjacent to Process.label (max distance <= 1 grid row).",
    "All input-role groups must be placed left of process anchor when flowAxis=leftToRight.",
    "All output-role groups must be placed right of process anchor when flowAxis=leftToRight.",
    "Slots in the same Group must share the same leading alignment and spacing.",
    "If operators.showFlowGlyphs=true, glyphs must use glyphStyleRole=muted and never use semantic colors.",
    "Any progress bar must have an explicit label (Process.label.text non-empty).",
    "Empty state text must be inside the owning Group (content.stateText), never global."
  ]
}
